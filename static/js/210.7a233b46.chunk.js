"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[210],{27210:function(t,e,n){n.r(e),n.d(e,{default:function(){return Mt}});var r=n(29439),i=n(95193),a=n(13239),o=n(18073),c=n(1413),s=n(66934),u=n(43896),l=n(80184),d=(0,s.ZP)((function(t){return(0,l.jsx)(u.Z,(0,c.Z)({disableRipple:!0},t))}))((function(t){var e=t.theme;return{textTransform:"none",color:e.palette.secondary.main,fontWeight:800,"&:hover":{color:e.palette.secondary.light},"&.Mui-selected":{color:e.palette.primary.contrastText},"&.Mui-focusVisible":{backgroundColor:e.palette.primary.contrastText}}})),x=n(83791),h=n(65762),f=n(14398),p=n(50525),Z=n(72791),v=n(39230),j=n(45987),m=n(97552),g=["width","children","value","index","key"],w=function(t){var e=t.width,n=t.children,r=t.value,i=t.index,a=t.key,o=(0,j.Z)(t,g);return(0,l.jsx)(m.E.div,{style:{position:"absolute",top:"60px"},initial:{opacity:0,translateX:0===i?-1*e:e,zIndex:0},exit:{opacity:0,translateX:0===i?e:-1*e,zIndex:1},animate:{opacity:1,translateX:0},transition:{duration:.3},children:(0,l.jsx)("div",(0,c.Z)((0,c.Z)({role:"tabpanel",style:{width:"".concat(e,"px"),padding:"15px"},hidden:r!==i,id:"tabpanel-".concat(i)},o),{},{children:(0,l.jsx)("div",{children:n})}))},a)},b=(0,Z.memo)(w),C=n(90493),y=n(94721),k=n(22885),R=n(81131),S=n(15021),E=n(20653),U=n(56125),D=n(66905),I=n(34855),A=n(4942),X=n(73974),O=n(49900),P=(0,s.ZP)(X.ZP)({padding:10}),F=(0,s.ZP)("div")((function(t){var e,n=t.theme;return e={width:"300px"},(0,A.Z)(e,n.breakpoints.up("sm"),{width:"450px"}),(0,A.Z)(e,"borderBottom",1),(0,A.Z)(e,"borderColor","divider"),e})),N=(0,s.ZP)(O.Z)((function(t){var e=t.theme;return{borderBottom:1,borderColor:"divider","& span":(0,A.Z)({width:"158px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.breakpoints.up("sm"),{width:"308px"})}})),T=n(13368),z=n(43416),B=n(20890),L=n(64554),W=n(41178),G=n(85170),K=n(74165),M=n(15861),Q=n(73418),$=n(91797),Y=n(25983),H=n(57177),q=n(86426),J=n(69061),V=n(96403),_=function(){var t=(0,V.NL)();return(0,Z.useCallback)((function(e,n){t.setQueryData([J.CU+q.RR],(function(t){var r=(0,c.Z)((0,c.Z)({},n),e);return t?t.map((function(t){return t.id===r.id?r:t})):[r]}))}),[t])},tt=function(){var t=(0,V.NL)();return(0,Z.useCallback)((function(e,n){t.setQueryData([J.CU+q.RR],(function(t){return t?t.filter((function(t){return t.id!==n})):[]}))}),[t])},et=n(93433),nt=function(){var t=(0,V.NL)();return(0,Z.useCallback)((function(e,n,r){t.setQueryData([J.CU+q.RR],(function(t){var i=(0,c.Z)((0,c.Z)({},e),{},{user:n,creator:r});return t?t.findIndex((function(t){return t.id==i.id}))>-1?t:[].concat((0,et.Z)(t),[i]):[i]}))}),[t])},rt=function(){var t=(0,H.D)().setSnackbar,e=(0,I.x)().currentUser,n=nt(),r=function(){var t=(0,M.Z)((0,K.Z)().mark((function t(e){var n;return(0,K.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,Y.o)(J.CU+(0,J.yz)(e.id)+q.AK),t.abrupt("return",(0,$.sg)(n,{}).then((function(t){return t.data})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Q.D)((function(t){return r(t)}),{onSuccess:function(t,r){e&&n(t,r,e)},onError:function(e){t({severity:"error",message:null===e||void 0===e?void 0:e.toString()})}})},it=function(){var t=(0,V.NL)();return(0,Z.useCallback)((function(e,n){t.setQueryData([J.CU+q.RR],(function(t){var r=(0,c.Z)((0,c.Z)({},n),e);return t?t.map((function(t){return t.id===r.id?r:t})):[r]}))}),[t])},at=n(64558),ot=n(5479),ct=n(3155),st=n(64658),ut=n(72664),lt=n(77146),dt=["state"],xt=function(t){var e=t.state,n=(0,j.Z)(t,dt);return(0,l.jsx)(lt.w,(0,c.Z)((0,c.Z)({},n),{},{disableHover:!0,children:function(){switch(e){case G.X.ReOpened:return(0,l.jsx)(st.Z,{});case G.X.Accepted:return(0,l.jsx)(ot.Z,{});case G.X.Rejected:return(0,l.jsx)(ut.Z,{});case G.X.Blocked:return(0,l.jsx)(at.Z,{});default:return(0,l.jsx)(ct.Z,{})}}()}))},ht=(0,Z.memo)(xt),ft={variant:"outlined",color:"secondary"},pt={textAlign:"center"},Zt=function(t){var e=t.collaborant,n=(0,I.x)().currentUser,r=(0,v.$G)().t,i=function(){var t=(0,I.x)().currentUser,e=(0,H.D)().setSnackbar,n=_();if(!t)throw new Error("No current user");var r=function(){var e=(0,M.Z)((0,K.Z)().mark((function e(n){var r,i;return(0,K.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id===n.creator.id,i=(0,Y.o)(J.CU+(0,J.yz)(r?n.user.id:n.creator.id)+q.AK+q.oy),e.abrupt("return",(0,$.pE)(i,{}).then((function(t){return t.data})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,Q.D)((function(t){return r(t)}),{onSuccess:n,onError:function(t){e({severity:"error",message:null===t||void 0===t?void 0:t.toString()})}})}(),a=function(){var t=(0,I.x)().currentUser,e=(0,H.D)().setSnackbar,n=it();if(!t)throw new Error("No current user");var r=function(){var e=(0,M.Z)((0,K.Z)().mark((function e(n){var r,i;return(0,K.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id===n.creator.id,i=(0,Y.o)(J.CU+(0,J.yz)(r?n.user.id:n.creator.id)+q.AK+q.d),e.abrupt("return",(0,$.pE)(i,{}).then((function(t){return t.data})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,Q.D)((function(t){return r(t)}),{onSuccess:n,onError:function(t){e({severity:"error",message:null===t||void 0===t?void 0:t.toString()})}})}(),o=function(){var t=(0,I.x)().currentUser,e=(0,H.D)().setSnackbar,n=tt();if(!t)throw new Error("No current user");var r=function(){var t=(0,M.Z)((0,K.Z)().mark((function t(e){var n;return(0,K.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,Y.o)(J.CU+q.RR,(0,q.np)(e)),t.abrupt("return",(0,$.QW)(n).then((function(t){return t.data})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,Q.D)((function(t){return r(t)}),{onSuccess:n,onError:function(t){e({severity:"error",message:null===t||void 0===t?void 0:t.toString()})}})}(),s=rt(),u=e.creator.id===(null===n||void 0===n?void 0:n.id),d=e.user.id===(null===n||void 0===n?void 0:n.id);if(!u&&!d)return(0,l.jsx)(l.Fragment,{});var x=(0,l.jsx)(l.Fragment,{});return e.state===G.X.Pending?x=u?(0,l.jsx)(B.Z,(0,c.Z)((0,c.Z)({},pt),{},{children:r(p.w.WaitingForAcceptance)})):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(B.Z,(0,c.Z)((0,c.Z)({},pt),{},{children:r(p.w.WaitingForAcceptance)})),(0,l.jsxs)(L.Z,{sx:{display:"flex",gap:2},children:[(0,l.jsx)(W.z,(0,c.Z)((0,c.Z)({},ft),{},{onClick:function(){return i.mutate(e)},startIcon:(0,l.jsx)(ht,{state:G.X.Accepted}),children:r(p.w.Accept)})),(0,l.jsx)(W.z,(0,c.Z)((0,c.Z)({},ft),{},{onClick:function(){return a.mutate(e)},startIcon:(0,l.jsx)(ht,{state:G.X.Rejected}),children:r(p.w.Reject)}))]})," "]}):e.state===G.X.ReOpened?x=u?(0,l.jsx)(B.Z,(0,c.Z)((0,c.Z)({},pt),{},{children:r(p.w.WaitingForAcceptance)})):(0,l.jsxs)(L.Z,{sx:{display:"flex",gap:2},children:[(0,l.jsxs)(W.z,(0,c.Z)((0,c.Z)({},ft),{},{onClick:function(){return i.mutate(e)},children:[(0,l.jsx)(ht,{state:G.X.Accepted}),r(p.w.Accept)]})),(0,l.jsx)(W.z,(0,c.Z)((0,c.Z)({},ft),{},{onClick:function(){return a.mutate(e)},startIcon:(0,l.jsx)(ht,{state:G.X.Blocked}),children:r(p.w.Block)}))]}):e.state===G.X.Accepted?x=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(B.Z,(0,c.Z)((0,c.Z)({},pt),{},{children:r(p.w.AlreadyCollaborant)})),(0,l.jsx)(W.z,(0,c.Z)((0,c.Z)({},ft),{},{onClick:function(){return o.mutate(e.id)},startIcon:(0,l.jsx)(T.Z,{}),children:r(p.w.DeleteCollaboration)}))]}):e.state===G.X.Rejected?x=u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(B.Z,(0,c.Z)((0,c.Z)({},pt),{},{children:r(p.w.UserRejectedCollaboration)})),(0,l.jsx)(W.z,(0,c.Z)((0,c.Z)({},ft),{},{onClick:function(){return s.mutate(e.user)},startIcon:(0,l.jsx)(ht,{state:G.X.ReOpened}),children:r(p.w.InviteAgain)}))]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(B.Z,(0,c.Z)((0,c.Z)({},pt),{},{children:r(p.w.YouRejectedButCanAccept)})),(0,l.jsx)(W.z,(0,c.Z)((0,c.Z)({},ft),{},{onClick:function(){return i.mutate(e)},startIcon:(0,l.jsx)(ht,{state:G.X.Accepted}),children:r(p.w.Accept)}))]}):e.state===G.X.Blocked&&(x=u?(0,l.jsx)(B.Z,(0,c.Z)((0,c.Z)({},pt),{},{children:r(p.w.CollaborationBlocked)})):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(B.Z,(0,c.Z)((0,c.Z)({},pt),{},{children:r(p.w.YouBlockedButCanUnblock)})),(0,l.jsx)(W.z,(0,c.Z)((0,c.Z)({},ft),{},{onClick:function(){return o.mutate(e.id)},startIcon:(0,l.jsx)(z.Z,{}),children:r(p.w.Unblock)}))]})),(0,l.jsx)(S.ZP,{sx:{display:"flex",flexWrap:"wrap",gap:1,justifyContent:"center"},children:x})},vt=(0,Z.memo)(Zt),jt=function(t){var e=t.collaborant,n=(0,Z.useState)(!1),i=(0,r.Z)(n,2),a=i[0],o=i[1],c=(0,I.x)().currentUser,s=e.user.id===(null===c||void 0===c?void 0:c.id),u=e.creator.id===(null===c||void 0===c?void 0:c.id);if(!s&&!u)return(0,l.jsx)(l.Fragment,{});var d=s?e.creator:e.user;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.ZP,{onClick:function(){o(!a)},sx:{cursor:"pointer"},children:[(0,l.jsxs)(E.Z,{sx:{position:"relative"},children:[(0,l.jsx)(D.Z,{userData:d}),(0,l.jsx)(ht,{state:e.state,sx:{position:"absolute",top:-5,right:5,transform:"scale(0.8)"}})]}),(0,l.jsx)(N,{primary:d.displayName,secondary:d.email}),a?(0,l.jsx)(k.Z,{}):(0,l.jsx)(R.Z,{})]}),(0,l.jsx)(U.Z,{in:a,timeout:"auto",unmountOnExit:!0,children:(0,l.jsx)(vt,{collaborant:e})})]})},mt=n(20385),gt=n(15529),wt=function(t){var e=t.handleOpenInviteTab,n=(0,v.$G)().t;return(0,l.jsx)(gt.Z,{image:(0,l.jsx)(mt.D,{}),imageStylesOverride:{width:{xs:150},height:{xs:100}},headerText:n(p.w.YouHaveNoCollaborants),actionButton:{children:n(p.w.InviteCollaborants),onClick:function(){return e()}},reversed:!0})},bt=(0,Z.memo)(wt),Ct=function(t){var e=t.collaborants,n=t.handleOpenInviteTab;return!e||e.length<1?(0,l.jsx)(bt,{handleOpenInviteTab:n}):(0,l.jsx)(C.Z,{children:e.map((function(t,n){return(0,l.jsxs)(l.Fragment,{children:[n>0&&n<e.length-1&&(0,l.jsx)(y.Z,{}),(0,l.jsx)(jt,{collaborant:t},t.id)]})}))})},yt=(0,Z.memo)(Ct),kt=n(13244),Rt=n(83199),St=n(57482),Et=n(20068),Ut=(0,s.ZP)(B.Z)((function(t){var e=t.theme;return{"& > mark":{backgroundColor:e.palette.primary.contrastText,color:e.palette.primary.main}}})),Dt=["text","highlightLength","highlightStartIndex"],It=function(t){var e=t.text,n=t.highlightLength,r=t.highlightStartIndex,i=(0,j.Z)(t,Dt);return(0,l.jsxs)(Ut,(0,c.Z)((0,c.Z)({},i),{},{children:[e.slice(0,r),(0,l.jsx)("mark",{children:e.substring(r,r+n)}),e.substring(r+n)]}))},At=(0,Z.memo)(It),Xt=n(29170),Ot=n(50362),Pt=n(12917),Ft=n(10982),Nt=function(){var t=(0,v.$G)().t;return(0,l.jsx)(gt.Z,{image:(0,l.jsx)(Ft.x,{}),imageStylesOverride:{width:{xs:150},height:{xs:100}},headerText:t(p.w.EmptySearchResults),reversed:!0})},Tt=(0,Z.memo)(Nt),zt=(0,s.ZP)(C.Z)({width:"100%",maxWidth:360}),Bt=(0,s.ZP)(O.Z)({"& span, & p":{overflow:"hidden",whiteSpace:"norap",textOverflow:"ellipsis"}}),Lt=function(t){var e,n,i=t.userCollaborants,a=(0,Z.useState)(""),o=(0,r.Z)(a,2),c=o[0],s=o[1],u=(0,I.x)().currentUser,d=(0,v.$G)().t,x=rt(),h=function(t,e){var n=function(){var e=(0,M.Z)((0,K.Z)().mark((function e(){return(0,K.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,$.R1)((0,Y.o)(J.CU,void 0,(0,A.Z)({},"searchPhrase",t))).then((function(t){return t.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,Pt.a)([J.CU,t],n,e)}(c,{enabled:!1}),f=(0,Z.useCallback)((0,Rt.Z)((function(){h.refetch()}),400),[]);(0,Z.useEffect)((function(){c.length>0&&h.isStale&&f()}),[f,h.isStale,c]);var j=(0,Z.useMemo)((function(){var t=new Map;return i.forEach((function(e){e.creator.id===(null===u||void 0===u?void 0:u.id)?t.set(e.user.id,e):t.set(e.creator.id,e)})),t}),[null===u||void 0===u?void 0:u.id,i]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Xt.n,{placeholder:d(p.w.SearchForUser),onChange:function(t){s(t.target.value)}}),h.isFetching?(0,l.jsx)(St.Z,{sx:{marginTop:"5px"}}):(0,l.jsx)("div",{style:{marginTop:9}}),h.data&&(null===(e=h.data)||void 0===e?void 0:e.length)>0?(0,l.jsx)(zt,{children:null===(n=h.data)||void 0===n?void 0:n.map((function(t){var e=j.get(t.id);return e?(0,l.jsx)(jt,{collaborant:e}):(0,l.jsxs)(S.ZP,{dense:!0,children:[(0,l.jsx)(E.Z,{children:(0,l.jsx)(Ot.Z,{userData:t})}),(0,l.jsx)(Bt,{primary:(0,l.jsx)(At,{text:t.displayName,highlightLength:c.length,highlightStartIndex:t.displayName.indexOf(c)}),secondary:(0,l.jsx)(At,{text:t.email,highlightLength:c.length,highlightStartIndex:t.email.indexOf(c)})}),t.id!==(null===u||void 0===u?void 0:u.id)&&(0,l.jsx)(Et.Z,{title:d(p.w.InviteUser),children:(0,l.jsx)("div",{children:(0,l.jsx)(kt.Z,{sx:{cursor:"pointer"},onClick:function(){x.mutate(t)}})})})]},t.id)}))}):(0,l.jsx)(Tt,{})]})},Wt=(0,Z.memo)(Lt),Gt=n(64694),Kt=function(){var t=(0,h.q)(),e=t.dialogsState.collaborantsDrawer.visible,n=t.dialogsActions.updateCollaborantsDrawer,c=(0,f.Z)(e,(function(){return n({visible:!1})})),s=(0,r.Z)(c,2),u=s[0],j=s[1],m=(0,i.Z)("(max-width:500px)")?300:450,g=(0,Z.useState)(0),w=(0,r.Z)(g,2),C=w[0],y=w[1],k=(0,Gt.f)(),R=(0,v.$G)().t;if(k.isLoading)return(0,l.jsx)(a.Z,{});return(0,l.jsxs)(P,{open:u,onClose:j,anchor:"right",children:[(0,l.jsx)(F,{style:{width:"".concat(m,"px")},children:(0,l.jsxs)(o.Z,{value:C,onChange:function(t,e){y(e)},children:[(0,l.jsx)(d,{label:R(p.w.Collaborants),value:0,id:"CollaborantsList"}),(0,l.jsx)(d,{label:R(p.w.CollaborantsSearch),value:1,id:"CollaborantsSearch"})]})}),(0,l.jsxs)(x.M,{children:[(0,l.jsx)(b,{value:0,index:C,width:m,children:(0,l.jsx)(yt,{collaborants:k.data||[],handleOpenInviteTab:function(){return y(1)}})},"".concat(C,"-0")),(0,l.jsx)(b,{value:1,index:C,width:m,children:(0,l.jsx)(Wt,{userCollaborants:k.data||[]})},"".concat(C,"-1"))]})]})},Mt=(0,Z.memo)(Kt)},64694:function(t,e,n){n.d(e,{f:function(){return l}});var r=n(74165),i=n(15861),a=n(12917),o=n(91797),c=n(25983),s=n(86426),u=n(69061),l=function(t){var e=function(){var t=(0,i.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.R1)((0,c.o)(u.CU+s.RR)).then((function(t){return t.data}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,a.a)([u.CU+s.RR],e,t)}},85170:function(t,e,n){n.d(e,{X:function(){return r}});var r=function(t){return t.Pending="PENDING",t.Accepted="ACCEPTED",t.Rejected="REJECTED",t.ReOpened="REOPENED",t.Blocked="BLOCKED",t}({})},86426:function(t,e,n){n.d(e,{AK:function(){return a},RR:function(){return r},d:function(){return o},np:function(){return i},oy:function(){return c}});var r="/collaborants",i=function(t){return"/".concat(t||":collaborationId")},a="/inviteCollaborant",o="/reject",c="/accept"}}]);
//# sourceMappingURL=210.7a233b46.chunk.js.map